---
id: instructions-for-publishing
slug: instructions-for-publishing
title: Instructions For Publishing
sidebar_label: Publishing instructions
tags:
  - eu
  - gajger
parent: 
source: 
date_created: 2025-07-25 
---
## Why we use the update script

**Obsidian is the source of truth.** Only a *subset* of that vault should go public. Simply dragging files into a Docusaurus project with Finder isn‚Äôt enough because:

- Links in Obsidian are flexible; Docusaurus is pickier.
- Attachments must live under `static/` to be served.
- We want predictable, repeatable builds without hand-fixing links each time.

The **update script** solves this by copying the chosen vault subset into the site‚Äôs `docs/` (recursively), copying `attachments/` into `static/attachments`, and **rewriting only attachment links** to site-absolute paths. Markdown inter-doc links are kept as plain file links so Docusaurus can resolve them reliably.

---

## What lives where (mental model)

- **Obsidian vault**: everything you write (private + public).  
- **Per-site Docusaurus repo**: only what you publish for that site (`docs/`, `static/attachments/`, config, theme).  
- **GitHub Pages**: serves the built output from the `gh-pages` branch.

You‚Äôll keep normal history on `main` (your source), and deploy static files to `gh-pages`.

---

## Conventions that keep builds boring (in a good way)

**Filenames**
- Use **kebab-case**: `my-note-name.md`.

**Internal links between docs**
- Use **explicit file links** with extension:  
  `./path/to/note.md`  
  (No need for `id:`/`slug:` frontmatter; we‚Äôve stopped doing manual IDs/slugs.)

**Attachments**
- Keep a folder named `attachments/` **sibling to** `docs/` in the vault subset.  
- Link to them as `attachments/image.jpg` in your docs.  
- The script rewrites these to `](/attachments/image.jpg)` and copies files to `static/attachments`.

**Sidebars & ordering**
- Prefer **autogenerated sidebars**.
- For category labels/positions, use `_category_.json` in each folder:
  ```json
  { "label": "Core", "position": 2, "collapsed": false }
  ```
- For specific doc ordering **inside** a folder, add `sidebar_position:` in the doc‚Äôs frontmatter **only when needed**. Otherwise alphabetical is fine.

---

## One-time setup per new site

1) **Create the site**
```bash
npx create-docusaurus@latest <site-name> classic
cd <site-name>
```

2) **Add scripts** (`package.json`)
```json
{
  "scripts": {
    "sync": "node update-project-content.js",
    "start": "docusaurus start",
    "build": "docusaurus build",
    "deploy": "docusaurus deploy",
    "clear": "docusaurus clear"
  }
}
```

3) **Drop in the update script**  
Place `update-project-content.js` at the project root and set:
```js
const DEFAULT_VAULT_PROJECT_ROOT = "/absolute/path/to/vault/subset";
// e.g. "/Users/chrisstevens/Documents/cicely_ak/house-construction"
```
(You can also override via env var:  
`VAULT_PROJECT_ROOT="/abs/path" npm run sync`)

4) **GitHub Pages config** (`docusaurus.config.js`)
```js
url: 'https://alexstarbuck.github.io',
baseUrl: '/house-construction/',
organizationName: 'alexstarbuck',
projectName: 'house-construction',
deploymentBranch: 'gh-pages',
onBrokenLinks: 'throw',
onBrokenMarkdownLinks: 'warn'
```

5) **.gitignore**
```
node_modules/
build/
.docusaurus/
.cache/
.DS_Store
.env
.env.*.local
```

6) **Create `gh-pages` branch once**
- Easiest in GitHub UI: create branch `gh-pages` from `main`.
- Or CLI with worktree (safe):
  ```bash
  git switch main
  git worktree add -B gh-pages ../.gh-pages
  (cd ../.gh-pages && rm -rf ./* && touch .nojekyll && git add . && git commit -m "init gh-pages" && git push -u origin gh-pages)
  git worktree remove ../.gh-pages
  ```

7) **Enable Pages** (GitHub ‚Üí Settings ‚Üí Pages):  
Source = **Branch: `gh-pages`**, Folder = **`/ (root)`**.

---

## Daily ‚Äúpublish‚Äù routine

```bash
# 1) Pull latest site repo (optional)
git pull

# 2) Sync from vault ‚Üí site
npm run sync

# 3) Preview locally (optional)
npm run start      # Ctrl+C to stop

# 4) Commit source changes to main (recommended)
git add docs static/attachments
git commit -m "sync: update content"
git push

# 5) Deploy (builds and pushes to gh-pages)
npm run deploy
```

Your site updates at:
`https://alexstarbuck.github.io/house-construction/`

---

## MoC / Intro page

A simple `docs/intro.md` is enough. Minimal frontmatter works:
```md
---
title: Intro
sidebar_label: Intro
sidebar_position: 1
---
## Map of Content

- [Planning](./core/01-planning.md)
- [Demolition & Excavation](./core/02-demolition-and-excavation.md)
- [Foundation & Waterproofing](./core/03-foundation-and-waterproofing.md)
- [Superstructure & Roof](./core/04-superstructure-and-roof.md)
- [Finalization & Approvals](./core/05-finalization-and-approvals.md)
```

If you want categories above/below Intro, give folders positions via `_category_.json` as shown earlier.

*(We no longer force `id:`/`slug:` on docs; only add `sidebar_position:` when you need custom order.)*

---

## Troubleshooting quickies

- **Broken links:** add `.md` to inter-doc links; ensure files exist under `docs/`.  
- **Wrong project building:** run from the correct folder and ensure `node -e "console.log(require.resolve('@docusaurus/core/package.json'))"` resolves inside this site‚Äôs `node_modules`.  
- **Sidebar order weird:** add `_category_.json` for folder label/position; add `sidebar_position:` in docs only where necessary.  
- **Cache issues:** `npm run clear` then rebuild.




---

## OLD VERSION


### VERY high level explanation

| Tool                 | Purpose                                                                   |
| -------------------- | ------------------------------------------------------------------------- |
| **Obsidian**         | Writing your notes in Markdown (GUI)                                      |
| **Markdown**         | The language your notes are written in ‚Äî portable and readable            |
| **Docusaurus**       | Turns Markdown into a structured website (docs, navigation, build system) |
| **Node script**      | Copies vault ‚Üí Docusaurus .../docs/ folder, adjusts internal links        |
| **Git**              | Tracks changes and syncs the whole project to GitHub                      |
| **GitHub Pages**     | Hosts your final website at a public URL                                  |
| **Local dev server** | Lets you test the site on your machine (`npm run serve`)                  |

### Obsidian ‚Üí GitHub Pages (via Docusaurus) Publishing Pipeline

This is a standardized workflow for maintaining clean, publishable project Wikis from within Obsidian.

---
#### 1. ‚úçÔ∏è Writing the Notes

- Write in Obsidian, as usual, within your vault;
- Keep all content in proper Markdown format `.md`;
- Feel free to use `[Wiki-Style](Wiki-Style)` links here;
	- (see #5 here below, regarding the concept of "*frontmatter*"!);
- If any attachment files, keep them in an `/attachments` folder WITHIN the project root, NOT in a global vault's `/attachments` folder;

---
#### 2. üß± Naming Conventions

- Use **kebab-case** for all filenames:
	- ‚úÖ `this-is-an-example.md`;
	- ‚ùå `ThisIsBad.md` or `this one also bad.md`;

---
#### 3. üîó Internal Linking

- While writing, use **wiki-style links** (`[filename](filename)`) for speed;
- Before publishing:
	- Run the **Link Converter plugin** to turn wiki links into Markdown format: `[Label](./filename.md)` > safe to choose vault-wide option, let it replace all links;
	- ‚ö†Ô∏è Obsidian‚Äôs plugin may omit the `./` ‚Äî that's OK, the `update-project-content.js` script will handle both variants;

---
#### 4. üìÇ Project Setup

To create a new public-facing wiki/project from local vault folder:

1. Open Terminal;
2. Navigate to `~/Documents/` and scaffold a Docusaurus site:
	- `npx create-docusaurus@latest [your-project-name] classic`;
3. Copy the `update-project-content.js` script from an existing project "AI Therapist Assistant":
	- `cp ~/Documents/ai-therapist-wiki/update-project-content.js ~/Documents/[your-project-root]/`;
4. Edit `update-project-content.js`:
	- Update paths to match your Obsidian vault and new Project folder's `.../docs/`;
	- This script:
	     - **Copies** Obsidian vault's `project folder` untouched into Docusaurus `project folder/vault/` > anyone pulling the repo can later "rebuild" this as their own, completely functional, local Obsidian vault, with links, attachments and all;
	     - **Copies** Obsidian project's `/docs/` folder to the Docusaurus `/docs/` folder;
	     - **Rewrites internal links** from `./file.md` ‚Üí `/docs/file` , which during build gets routed (replaced) with `/docs/slug`, same for attachments' links as well;
	     - Copies vaults `/attachments/` into Docusaurus' project `/static/attachments` to be served once deployed to web;

---
#### 5. ‚öôÔ∏è Templating & MoC

- Use the **Templater plugin** to insert standard frontmatter in new notes: `Ctrl+T` or `Ctrl+P` ‚Üí "Templater: Insert template";
- Then run the template with `Ctrl+R`;
- Your `index.md` (Map of Content) must:
	- Be located at the root of the `docs/` directory;
	- Have the following in its frontmatter:
    ```
    ---
    id: index
    title: [whatever]
    sidebar_label: Index
    slug: /
    ---
    ```
	- This will make it the **homepage** for your published project;
	- `id` MUST be the exact same as the "filename.md", `slug` MUST be "/";

---
#### 6. ‚ö° Generating the MoC (Index.md) Automatically

- To avoid compiling all internal links here manually:
	- Use the `generate-index-links` template (Templater);
	- Insert with `Ctrl+T`, then run it with `Ctrl+R`

---
‚úÖ You‚Äôre now ready to sync, transform, and publish your project wiki to Docusaurus. Enjoy your static site with full Markdown control!